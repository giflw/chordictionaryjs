/*!Chordictionary v0.1.0, @license MIT, (c) 2016 Hubert Fauconnier + contributors*/
!function(a){"use strict";function b(){function e(a,b,d){for(var e,f,g={},h=0;h<a.length;h++)if(!isNaN(a[h])){f=a[h]+c.indexOf(d[h]),f>c.length-1&&(f-=c.length);for(var i=0;i<b.length;i++)g[c[f]]?c[f]==c[i]&&g[c[f]]++:g[c[f]]=1}for(var i=0;i<b.length;i++){if(!(b[i]in g)){e=!1;break}e=!0}return e}function f(a,c){var c=c||"EADGBE",d=[];try{if(a.length<=c.length)return a.split("");if(a.length==2*c.length){for(var e=0;e<a.length;e++)e%2||d.push(a.slice(e,e+2));return d}if(a.length>c.length){if(k(a.split(""),"max")>1){for(var e=0;e<a.length;e++)-1!=a.charAt(e).search(/[x02-9]/i)||1==a.charAt(e)&&-1!=a.charAt(e+1).search(/x/i)?d.push(a.slice(e,e+1)):-1==a.charAt(e+1).search(/x/i)&&(d.push(a.slice(e,e+2)),e++);return d}throw b.invalidTab}}catch(f){return!1}}function g(a){var c=[],d=new RegExp("^[a-g]+$","i"),e=new RegExp("^[#a-g]+$","i");try{if(d.test(a))return a.toUpperCase().split("");if(e.test(a)){a=a.toUpperCase();for(var f=0;f<a.length;f++)"#"!=a.charAt(f)&&("#"!=a.charAt(f+1)?c.push(a.slice(f,f+1)):(c.push(a.slice(f,f+2)),f++));return c}throw b.invalidTuning}catch(g){return!1}}function h(a){var c,d;try{if("string"!=typeof a)throw b.invalidChordName;var e=a.search("#");return-1==e?(c=a.charAt(0),d=a.slice(1)):(c=a.slice(0,2).toUpperCase(),d=a.slice(2)),[c,d]}catch(f){return!1}}function i(a){try{if(!Array.isArray(a))throw a+" is not an array.";var a=a;return a.filter(function(a,b,c){return b==c.indexOf(a)})}catch(b){return!1}}function j(a,b){try{if("object"==typeof a){var a=a;if("string"==typeof b)var b=b.toLowerCase();for(var c=0;c<a.length;c++)for(var d in a[c]){if(a[c][d]==b)return a[c];if("string"==typeof a[c][d]&&a[c][d].toLowerCase()==b)return a[c]}throw"Couldn't find "+b+" in "+a}throw a+" is not an object."}catch(e){return!1}}function k(a,b){var c;try{if(!Array.isArray(a))throw a+" is not an array.";var a=a;if(!b)throw"Missing parameter.";var b=b;switch(b){case"min":if(c=Math.min.apply(Math,a),!isNaN(c))return c;for(var d=0;d<a.length;d++)isNaN(a[d])||(isNaN(c)?c=a[d]:a[d]<c&&(c=a[d]));break;case"max":if(c=Math.max.apply(Math,a),!isNaN(c))return c;for(var d=0;d<a.length;d++)isNaN(a[d])||(isNaN(c)?c=a[d]:a[d]>c&&(c=a[d]));break;default:c=l(a.join(""),b)}}catch(e){return!1}return c}function l(a,b,c){if(a+="",b+="",b.length<=0)return a.length+1;for(var d=0,e=0,f=c?1:b.length;;){if(e=a.indexOf(b,e),!(e>=0))break;++d,e+=f}return d}var a={},b={invalidTab:'The tab should only be composed of "x" and numbers from 1 to 9.',invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",noMatch:"The tab didn't match any known chord."},c=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],d=[{formula:"1-3-5",integer:"047",name:"Major",suffix:""},{formula:"1-5",integer:"07",name:"Power chord",suffix:"5"},{formula:"1-4-5",integer:"057",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"027",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"04714",name:"Added ninth",suffix:"add9"},{formula:"1-3-5-6",integer:"0479",name:"Major Sixth",suffix:"6"},{formula:"1-3-5-6-9",integer:"047914",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7",integer:"04711",name:"Major seventh",suffix:"maj7"},{formula:"1-3-5-7-9",integer:"0471114",name:"Major ninth",suffix:"maj9"},{formula:"1-3-5-7-#11",integer:"0471118",name:"Major seventh, sharp eleventh",suffix:"maj7#11"},{formula:"1-3-5-7-9-13",integer:"047111421",name:"Major thirteen",suffix:"Maj13"},{formula:"1-b3-5",integer:"037",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"03714",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-b3-5-6",integer:"0379",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0378",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"037914",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-b3-5-b7",integer:"03710",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-5-7",integer:"03711",name:"Minor, major seventh",suffix:"m(maj7)"},{formula:"1-b3-5-b7",integer:"03610",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-b3-5-b7-9",integer:"0371014",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0371114",name:"Minor ninth, major seventh",suffix:"m9(maj7)"},{formula:"1-b3-b5-b7-9",integer:"0371014",name:"Minor eleventh",suffix:"m9b5"},{formula:"1-b3-5-b7-9-11-13",integer:"03710141721",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-b7",integer:"04710",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5#",integer:"048",name:"Augmented",suffix:"aug"},{formula:"1-3-b5",integer:"046",name:"Diminished",suffix:"dim"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-3-b7",integer:"0410",name:"Seventh",suffix:"7"},{formula:"1-3-6",integer:"049",name:"Sixth",suffix:"6"}];return a.getChordInfo=function(a,e){var h=[],j=[],k=[],l={error:"",name:"",tab:a,notes:"",tuning:e,formula:""};try{if(this.isValidTab(a))var a=f(a)}catch(m){return l.error=m,l}try{if(this.isValidTuning(e))var e=g(e)}catch(m){return l.error=m,l}var n,o;try{for(var p=0;p<a.length;p++)isNaN(a[p])?h.push("x"):(o=e[p],n=parseInt(a[p])+c.indexOf(o),n>c.length-1&&(n-=c.length),h.push(c[n]));l.notes=h.join("")}catch(m){return l.error=b.failedToConvertTabIntoNotes,l}var q=[];try{for(var p=0;p<e.length;p++)if(q.push({root:"",formula:[]}),h[p]&&"x"!=h[p])for(var r=0;r<h.length;r++)if(h[r]&&"x"!=h[r]){var s=c.indexOf(h[r])-c.indexOf(h[p]);0>s?s=c.length+s:0==s&&(q[p].root=h[r]),q[p].formula.push(s)}}catch(m){l.error=b.failedToCalculateFormula}for(var p=0;p<q.length;p++)if(""!=q[p].root){k.push(q[p].root),q[p].formula.sort(function(a,b){return a-b});var t=i(q[p].formula);j.push(t.join(""))}var u,w,v=[],x=[];try{for(var p=0;p<d.length;p++){u=d[p].integer;for(var r=0;r<j.length;r++)w=new RegExp("^"+j[r]+"$","g"),u.match(w)&&k[r]&&(x.push(k[r]+d[p].suffix),v.push(d[p].formula))}if(!(v.length>0))throw b.noMatch;if(v.length>1){var y=i(v);l.formula=y}else l.formula=v}catch(m){return l.error=m,l}if(x.length>1){var z=i(x);l.name=z}else l.name=x;return l},a.getChordsList=function(a,f,i,l){var m=4,n=[],l=l||0,o={error:"",chordList:[],offset:0};try{if("string"!=typeof a)throw b.invalidChordName;var a=h(a),p=a[0],q=a[1];if(n.push(p),this.isValidTuning(f))var f=g(f)}catch(r){return o.error=r,o}try{var s=j(d,q),t=s.integer}catch(r){return o.error=r,o}for(var u=1;u<t.length;u++){var v=parseInt(t[u])+parseInt(c.indexOf(p));v>c.length-1&&(v-=c.length),n.push(c[v])}for(var x,w=[],y=0;y<f.length;y++){w[y]=[],w[y].push("x");for(var z=0;z<n.length;z++)x=c.indexOf(n[z])-c.indexOf(f[y]),0>x&&(x=c.length+x),w[y].push(x)}for(var A=[],y=0;y<f.length;y++)for(var B=A.length,u=0;u<w[y].length;u++)if(A[u])for(var C=0;B>C;C++)if(0===u)A[C].push(w[y][u]);else{var D=A[C].slice(0);D.pop(),D.push(w[y][u]),A.push(D)}else A[u]=[w[y][u]];for(var E=[],F=l;F<A.length;F++)if(e(A[F],n,f)&&k(A[F],"max")-k(A[F],"min")<m){for(var u=0;u<A[F].length;u++)if(!isNaN(A[F][u])){var G=A[F][u]+c.indexOf(f[u]);if(A[F][u]<=4&&c.indexOf(p)==G&&A[F].lastIndexOf("x")<u){E.push(A[F]);break}break}if(i>0&&i<A[F].length&&E.length>=i){l=F+1;break}}return o.chordList=E,o.offset=l,o},a.getChordLayout=function(a,b,c,d){var e,h,d=isNaN(d)?0:d;try{if(this.isValidTab(b))var e=f(b);else var e=[0,0,0,0,0,0];if(this.isValidTuning(c))var c=g(c);else var c=["E","A","D","G","B","E"]}catch(i){return!1}for(var j=[],k=0;k<e.length;k++)isNaN(e[k])===!1&&j.push(e[k]);var l=Math.abs(Math.max.apply(Math,j)),m=1;l>d&&(m=Math.abs(Math.min.apply(Math,j)-1)),1===m&&l>5&&(m=l-3),0===d&&(d=l-m+2),h='<table class="chord">';for(var n=0;d>n;n++){var o=n+m-1;1==m&&0==n&&(h+="<thead>"),h+=o%2&&o>0?'<tr><th class="fret-number">'+o+"</th>":"<tr><th></th>";for(var p=0;p<c.length;p++)h+=0==n?0==e[p]?'<th><div class="dot open"></div></th>':"<th></th>":e[p]==m+n-1?'<td><div class="dot plain">'+e[p]+"</div></td>":"<td></td>";h+=1==m&&0==n?"<tr></thead>":"</tr>"}return h+='<caption align="bottom">'+a+"</caption>",h+="</table>"},a.isValidTab=function(a){var c=new RegExp("^[x0-9]*$","i");if(c.test(a))return!0;throw b.invalidTab},a.isValidTuning=function(a){var c=new RegExp("^[#a-g]+$","i");if(c.test(a))return!0;throw b.invalidTuning},a}"undefined"==typeof Chordictionary?a.Chordictionary=b():console.error()}(window);
