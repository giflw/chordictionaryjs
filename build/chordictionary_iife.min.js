(function () {
	'use strict';

	Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c);}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}/**Chordictionary v0.1.0-alpha.2, @license MIT, (c) 2016 Hubert Fauconnier + contributors*/var WORDING={croppedChordLayout:"Number of frets does not allow full display of the chord.",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",invalidTab:"The tab should only be composed of \"x\" and numbers from 1 to 9.",invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",noMatch:"The tab didn't match any known chord."},MDL_A_SCALE=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],MDL_CHORD_FORMULAS=[{formula:"1-3-5",integer:"0-4-7",name:"Major",suffix:""},{formula:"1-3-5#",integer:"0-4-8",name:"Augmented",suffix:"aug"},{formula:"1-b3-b5",integer:"0-3-6",name:"Diminished",suffix:"dim"},{formula:"1-b3-5",integer:"0-3-7",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"0-2-3-7",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-4-5",integer:"0-5-7",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"0-2-7",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"0-2-4-7",name:"Added ninth",suffix:"add9"},{formula:"1-3-b7",integer:"0-4-10",name:"Seventh",suffix:"7"},{formula:"1-3-5-b7",integer:"0-4-7-10",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5-7",integer:"0-4-7-11",name:"Major seventh",suffix:"maj7"},{formula:"1-b3-5-7",integer:"0-3-7-11",name:"Minor, major seventh",suffix:"m(maj7)"},{formula:"1-b3-5-b7",integer:"0-3-7-10",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-b5-b7",integer:"0-3-6-10",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-3-6",integer:"0-4-9",name:"Sixth",suffix:"6"},{formula:"1-b3-5-6",integer:"0-3-7-9",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0-3-7-8",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"0-2-3-7-9",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-3-5-6",integer:"0-4-7-9",name:"Major Sixth",suffix:"maj6"},{formula:"1-3-5-6-9",integer:"0-2-4-7-9",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7-9",integer:"0-2-4-7-11",name:"Major ninth",suffix:"maj9"},{formula:"1-b3-5-b7-9",integer:"0-2-3-7-10",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0-2-3-7-11",name:"Minor ninth, major seventh",suffix:"m9(maj7)"},{formula:"1-b3-b5-b7-9",integer:"0-2-3-6-10",name:"Minor eleventh",suffix:"m9b5"},{formula:"1-b3-5-b7-9-11-13",integer:"0-2-3-4-6-7-10",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-7-#11",integer:"0-4-7-11-18",name:"Major seventh, sharp eleventh",suffix:"maj7#11"},{formula:"1-3-5-7-9-13",integer:"0-2-4-7-9-11",name:"Major thirteen",suffix:"maj13"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-5",integer:"0-7",name:"Power chord",suffix:"5"}],Instrument=function(){var b=Math.min,c=Math.max;function a(b,c,d,e){_classCallCheck(this,a);try{this.isValidTuning(b)&&(this.tuning=splitTuning(b)),this.fretNumber=c,this.fretsToDisplay=isNaN(d)?0:d+1,this.maxSpan=isNaN(e)?4:e;}catch(a){return console.error(a),!1}return this}return _createClass(a,[{key:"getChordInfo",value:function(a){var b=[],c=[],d=[],f={error:"",name:"",tab:a,notes:"",tuning:this.tuning.join(""),formula:""};try{this.isValidTab(a)&&(a=splitTab(a));}catch(a){return f.error=a,f}var g,h;try{for(var k=0;k<a.length;k++)isNaN(a[k])?b.push("x"):(h=this.tuning[k],g=parseInt(a[k])+MDL_A_SCALE.indexOf(h),g>MDL_A_SCALE.length-1&&(g-=MDL_A_SCALE.length),b.push(MDL_A_SCALE[g]));f.notes=b.join("");}catch(a){return f.error=WORDING.failedToConvertTabIntoNotes,f}var e=[];try{for(var l=0;l<this.tuning.length;l++)if(e.push({root:"",formula:[]}),b[l]&&"x"!==b[l].toLowerCase())for(var m=0;m<b.length;m++)if(b[m]&&"x"!==b[m].toLowerCase()){var n=MDL_A_SCALE.indexOf(b[m])-MDL_A_SCALE.indexOf(b[l]);0>n?n=MDL_A_SCALE.length+n:0==n&&(e[l].root=b[m]),e[l].formula.push(n);}}catch(a){f.error=WORDING.failedToCalculateFormula;}for(var o=0;o<e.length;o++)if(""!==e[o].root){d.push(e[o].root),e[o].formula.sort(function(c,a){return c-a});var p=removeDuplicates(e[o].formula);c.push(p.join("-"));}var q,r,s=[],t=[];try{for(var u=0;u<MDL_CHORD_FORMULAS.length;u++){q=MDL_CHORD_FORMULAS[u].integer;for(var v=0;v<c.length;v++)r=new RegExp("^"+c[v]+"$","g"),q.match(r)&&d[v]&&(t.push(d[v]+MDL_CHORD_FORMULAS[u].suffix),s.push(MDL_CHORD_FORMULAS[u].formula));}if(!(0<s.length))throw WORDING.noMatch;else if(1<s.length){var w=removeDuplicates(s);f.formula=w;}else f.formula=s;}catch(a){return f.error=a,f}if(1<t.length){var x=removeDuplicates(t);f.name=x;}else f.name=t;return f}},{key:"getChordsList",value:function(a,b,c){var d=this;c=c||0;var e=[],f=void 0,g=void 0,h=[],j=void 0,k=void 0,l={error:"",chordList:[],offset:0},m={basic:{rootBelow4thFret:!0,noMuteAfterFirstNote:!0,rootIsLowestNote:!0,splittedChord:!1,openString:!0},powerchord:{frettedNotes:[2,3],rootIsLowestNote:!0,rootOnLowestFret:!0,splittedChord:!1,openString:!1},bar:{rootIsLowestNote:!0,rootOnLowestFret:!0,barredString:[3,6],noMuteAfterFirstNote:!0,splittedChord:!1,openString:!1}};try{if("string"==typeof a)a=splitChordName(a),j=a[0],f=a[1],e.push(j),k=MDL_A_SCALE.indexOf(j);else throw WORDING.invalidChordName;g=searchInObject(MDL_CHORD_FORMULAS,f),h=g.integer.split("-");}catch(a){return l.error=WORDING.invalidChordName,l}for(var n,o=1;o<h.length;o++)n=parseInt(h[o])+parseInt(k),n>MDL_A_SCALE.length-1&&(n-=MDL_A_SCALE.length),e.push(MDL_A_SCALE[n]);var p,q=[],r=0;for(r=0;r<this.tuning.length;r++){q[r]=[],q[r].push("x");for(var s=0;s<e.length;s++)p=MDL_A_SCALE.indexOf(e[s])-MDL_A_SCALE.indexOf(this.tuning[r]),0>p&&(p=MDL_A_SCALE.length+p),q[r].push(p),p+12<this.fretNumber&&q[r].push(p+12);}var t=[];for(r=0;r<this.tuning.length;r++)for(var u=t.length,v=0;v<q[r].length;v++)if(t[v]){for(var w=0;w<u;w++)if(0==v)t[w].push(q[r][v]);else{var x=t[w].slice(0);x.pop(),x.push(q[r][v]),t.push(x);}}else t[v]=[q[r][v]];var y=[],z=function(a,b){for(var c in a){if(!b.hasOwnProperty(c))return !1;if("object"===_typeof(a[c])){var d=a[c][0],e=a[c][1];if(b[c]<d||b[c]>e)return !1}else if(b[c]!==a[c])return !1}return !0};try{for(var A=c;A<t.length;A++)if(isValidChord(t[A],e,this.tuning)&&arrayFind(t[A],"max")-arrayFind(t[A],"min")<this.maxSpan&&function(){var a={openString:!1,frettedNotes:0},b=t[A].join(""),c=/[0-9]+[x]+[0-9]+/gi,e=/[0-9]+[x]+/gi;a.splittedChord=!!c.test(b),a.noMuteAfterFirstNote=!e.test(b);for(var f,g=0;g<t[A].length;g++)if(f=t[A][g],!isNaN(f)){var h=f+MDL_A_SCALE.indexOf(d.tuning[g]);0===f&&(a.openString=!0),k===h&&(0===a.frettedNotes&&(a.rootIsLowestNote=!0),a.rootBelow4thFret=!!(4>=f),a.rootOnLowestFret=!!(arrayFind(t[A],"min")>=f)),(0<f&&g<t[A].length-1&&f===t[A][g-1]||3<=arrayFind(t[A],f))&&(a.barredString=isNaN(a.barredString)?1:a.barredString+1),a.frettedNotes++;}var j={tab:t[A],tag:[]};Object.getOwnPropertyNames(m).forEach(function(b){z(m[b],a)&&j.tag.indexOf(b)&&j.tag.push(b);}),y.push(j);}(),0<b&&b<t[A].length&&y.length===b){c=A+1;break}}catch(a){console.error(a);}return l.chordList=y,l.offset=c,l}},{key:"getChordLayout",value:function(a,d){var f,g,e=Math.abs,h=this.fretsToDisplay;try{f=this.isValidTab(d)?splitTab(d):[0,0,0,0,0,0];}catch(a){return !1}for(var j=[],k=0;k<f.length;k++)!1===isNaN(f[k])&&j.push(f[k]);var l=e(c.apply(Math,j)),m=e(b.apply(Math,j)),n=1;l>=h&&(n=0<m?m:1),1===n&&5<l&&(n=l-h+2);try{if(0===h)h=l-n+2;else if(l-n+1>h-1)throw h=l-n+2,WORDING.croppedChordLayout}catch(a){console.error(a);}g="<table class=\"chord\">";for(var o,p=0;p<h;p++){o=p+n-1,1===n&&0==p&&(g+="<thead>"),g+=o%2&&0<o?"<tr><th class=\"fret-number\">"+o+"</th>":"<tr><th></th>";for(var q,r=0;r<this.tuning.length;r++)q=parseInt(f[r]),g+=0==p?0===q?"<th><div class=\"dot open\"></div></th>":"<th></th>":q===n+p-1?"<td><div class=\"dot plain\">"+f[r]+"</div></td>":"<td></td>";g+=1===n&&0==p?"<tr></thead>":"</tr>";}return g+="<caption align=\"bottom\">"+a+"</caption>",g+="</table>",g}},{key:"isValidTab",value:function(a){var b=/^[x0-9]*$/i;if(b.test(a))return !0;throw WORDING.invalidTab}},{key:"isValidTuning",value:function(a){var b=/^[#a-g]+$/i;if(b.test(a))return !0;throw WORDING.invalidTuning}}]),a}();function isValidChord(a,b,c){for(var d=void 0,e=void 0,f={},g=0;g<a.length;g++)if(!isNaN(a[g])){e=a[g]+MDL_A_SCALE.indexOf(c[g]),e>MDL_A_SCALE.length-1&&(e-=MDL_A_SCALE.length);for(var h=0;h<b.length;h++)f[MDL_A_SCALE[e]]?MDL_A_SCALE[e]===MDL_A_SCALE[h]&&f[MDL_A_SCALE[e]]++:f[MDL_A_SCALE[e]]=1;}for(var k=0;k<b.length;k++)if(b[k]in f)d=!0;else{d=!1;break}return d}function splitTab(a,b){a=a.toLowerCase(),b=b||"EADGBE";var c=[];if(a.length<=b.length)return a.split("");if(a.length===2*b.length){for(var d=0;d<a.length;d++)d%2||c.push(a.slice(d,d+2));return c}if(a.length>b.length){if(1<arrayFind(a.split(""),"max")){for(var e=0;e<a.length;e++)-1!==a.charAt(e).search(/[x02-9]/i)||1===a.charAt(e)&&-1!==a.charAt(e+1).search(/x/i)?c.push(a.slice(e,e+1)):-1===a.charAt(e+1).search(/x/i)&&(c.push(a.slice(e,e+2)),e++);return c}throw WORDING.invalidTab}else return !1}function splitTuning(a){var b=[],c=/^[a-g]+$/i,d=/^[#a-g]+$/i;if(c.test(a))return a.toUpperCase().split("");if(d.test(a)){a=a.toUpperCase();for(var e=0;e<a.length;e++)"#"!==a.charAt(e)&&("#"===a.charAt(e+1)?(b.push(a.slice(e,e+2)),e++):b.push(a.slice(e,e+1)));return b}throw WORDING.invalidTuning}function splitChordName(a){var b,c;try{if("string"!=typeof a)throw WORDING.invalidChordName;else{var d=a.search("#");return -1===d?(b=a.charAt(0),c=a.slice(1)):(b=a.slice(0,2).toUpperCase(),c=a.slice(2)),[b,c]}return result}catch(a){return !1}}function removeDuplicates(a){if(!Array.isArray(a))throw a+" is not an array.";else return a.filter(function(a,b,c){return b===c.indexOf(a)})}function searchInObject(a,b){if("object"===("undefined"==typeof a?"undefined":_typeof(a))){"string"==typeof b&&(b=b.toLowerCase());for(var c=0;c<a.length;c++)for(var d in a[c]){if(a[c][d]===b)return a[c];if("string"==typeof a[c][d]&&a[c][d].toLowerCase()===b)return a[c]}throw"Couldn't find "+b+" in "+a}else throw a+" is not an object."}function arrayFind(a,b){var c=Math.min,d=Math.max,e=!1;if(!Array.isArray(a))throw a+" is not an array.";if("undefined"==typeof b)throw"Missing parameter.";switch(b){case"min":if(e=c.apply(Math,a),!isNaN(e))return e;for(var f=0;f<a.length;f++)if(isNaN(a[f]))continue;else if(isNaN(e)){e=a[f];continue}else if(a[f]<e)e=a[f];else continue;break;case"max":if(e=d.apply(Math,a),!isNaN(e))return e;for(var g=0;g<a.length;g++)if(isNaN(a[g]))continue;else if(isNaN(e)){e=a[g];continue}else if(a[g]>e)e=a[g];else continue;break;default:e=occurrences(a.join(""),b);}return e}function occurrences(a,b,c){if(a+="",b+="",0>=b.length)return a.length+1;for(var d=0,e=0,f=c?1:b.length;e=a.indexOf(b,e),0<=e;)++d,e+=f;return d}exports.Instrument=Instrument;

}());
