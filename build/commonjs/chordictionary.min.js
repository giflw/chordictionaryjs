'use strict';function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}Object.defineProperty(exports,"__esModule",{value:!0});var WORDING={croppedChordLayout:"Number of frets does not allow full display of the chord.",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",invalidTab:"The tab should only be composed of \"x\" and numbers from 1 to 9.",invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",noMatch:"The tab didn't match any known chord."},NOTES=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],DIATONIC=["1","b2","2","b3","3","4","b5","5","#5","6","b7","7","8","b9","9","b10","10","11","#11","12","b13","13","#13","14"];function get(c,a){var b=NOTES.indexOf(a)-NOTES.indexOf(c);return 0>b&&(b=NOTES.length+b),b}var FORMULAS=[{formula:"1-3-5",integer:"0-4-7",name:"Major",suffix:""},{formula:"1-3-5#",integer:"0-4-8",name:"Augmented",suffix:"aug"},{formula:"1-b3-b5",integer:"0-3-6",name:"Diminished",suffix:"dim"},{formula:"1-b3-5",integer:"0-3-7",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"0-2-3-7",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-3-4-5",integer:"0-4-5-7",name:"Added fourth",suffix:"add4"},{formula:"1-4-5",integer:"0-5-7",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"0-2-7",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"0-2-4-7",name:"Added ninth",suffix:"add9"},{formula:"1-3-b7",integer:"0-4-10",name:"Seventh",suffix:"7"},{formula:"1-3-5-b7",integer:"0-4-7-10",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5-7",integer:"0-4-7-11",name:"Major seventh",suffix:"Maj7"},{formula:"1-b3-5-7",integer:"0-3-7-11",name:"Minor, major seventh",suffix:"m(Maj7)"},{formula:"1-b3-5-b7",integer:"0-3-7-10",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-b5-b7",integer:"0-3-6-10",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-3-6",integer:"0-4-9",name:"Sixth",suffix:"6"},{formula:"1-b3-5-6",integer:"0-3-7-9",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0-3-7-8",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"0-2-3-7-9",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-3-5-6",integer:"0-4-7-9",name:"Major Sixth",suffix:"Maj6"},{formula:"1-3-5-6-9",integer:"0-2-4-7-9",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7-9",integer:"0-2-4-7-11",name:"Major ninth",suffix:"Maj9"},{formula:"1-b3-5-b7-9",integer:"0-2-3-7-10",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0-2-3-7-11",name:"Minor ninth, major seventh",suffix:"m9(Maj7)"},{formula:"1-b3-b5-b7-9",integer:"0-2-3-6-10",name:"Minor ninth flat fifth",suffix:"m9b5"},{formula:"1-3-5-7-9-11",integer:"0-4-5-11",name:"Major eleventh (no fifth, no ninth)",suffix:"Maj11"},{formula:"1-3-5-7-9-11",integer:"0-4-5-7-11",name:"Major eleventh (no ninth)",suffix:"Maj11"},{formula:"1-3-5-7-9-11",integer:"0-2-4-5-7-11",name:"Major eleventh",suffix:"Maj11"},{formula:"1-b3-5-b7-9-11-13",integer:"0-2-3-4-6-7-10",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-b7-#11",integer:"0-4-6-7-10",name:"Seventh, sharp eleventh",suffix:"7#11"},{formula:"1-3-5-7-#11",integer:"0-4-6-7-11",name:"Major seventh, sharp eleventh",suffix:"Maj7#11"},{formula:"1-3-5-7-9-13",integer:"0-2-4-7-9-11",name:"Major thirteen",suffix:"Maj13"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-5",integer:"0-7",name:"Power chord",suffix:"5"}],NAMING={powerchord:["5","5 (powerchord)"],major:["Maj","Major"],minor:["min","Minor"],sharp5:["#5","Sharp 5th"],sharp11:["#11","Sharp 11th"],aug5:["aug","Augmented"],dim5:["dim","Diminished"],flat5:["b5","Flat 5th"],flat9:["b9","Flat 9th"],doubleflat5:["bb5","Double Flat 5th"],sus2:["sus2","Suspended 2nd"],sus4:["sus4","Suspended 4th"],b6:["b6","Flat 6th"],add2:["add2","Added 2nd"],add4:["add4","Added 4th"],add9:["add9","Added 9th"],major9:["Maj9","Major 9"],nine:["9","9th"],six:["6","6th"],sixnine:["6/9","Six Added Ninth"],seven:["7","7th"],major7:["Maj7","Major 7th"],eleven:["11","11th"],thirteen:["13","13th"]};function isValid(a,b,c){for(var d,e,f={},g=0;g<a.length;g++)if(!isNaN(a[g])){e=a[g]+NOTES.indexOf(c[g]),e>NOTES.length-1&&(e-=NOTES.length);for(var h=0;h<b.length;h++)f[NOTES[e]]?NOTES[e]===NOTES[h]&&f[NOTES[e]]++:f[NOTES[e]]=1}for(var k=0;k<b.length;k++)if(b[k]in f)d=!0;else{d=!1;break}return d}function parse(a){var b,c;try{if("string"!=typeof a)throw WORDING.invalidChordName;else{var d=a.search("#");return-1===d?(b=a.charAt(0),c=a.slice(1)):(b=a.slice(0,2).toUpperCase(),c=a.slice(2)),[b,c]}}catch(a){return!1}}function name(a){var b=a.map(function(a){return DIATONIC[a]}).filter(function(a){return a!==void 0}),c=b.filter(function(a){return["2"].includes(a)}).length,d={seven:b.some(function(a){return["b7","7"].includes(a)}),third:b.some(function(a){return["b3","3"].includes(a)}),fifth:b.some(function(a){return["b5","5","#5"].includes(a)}),majorNinth:b.includes("2")&&(b.some(function(a){return["b3","3"].includes(a)})||!(2>c))},e=[{name:"powerchord",check:b.includes("5")&&b.every(function(a){return["1","5"].includes(a)})},{name:"major",check:b.includes("3")&&!b.some(function(a){return["6","4"].includes(a)||d.seven||d.majorNinth})},{name:"minor",check:b.includes("b3")},{name:"aug5",check:b.includes("#5")&&b.includes("3")&&!b.includes("5")},{name:"dim5",check:b.includes("b5")&&b.includes("b3")&&!b.includes("5")&&!d.majorNinth},{name:"seven",check:b.includes("b7")&&!b.some(function(a){return["6","b9","9"].includes(a)||d.majorNinth})},{name:"major7",check:b.includes("7")&&!b.some(function(a){return["6","4"].includes(a)||d.majorNinth})},{name:"major9",check:d.majorNinth&&b.includes("7")&&!b.includes("6")},{name:"six",check:b.includes("6")&&!d.seven},{name:"nine",check:d.majorNinth&&b.includes("b7")},{name:"eleven",check:b.includes("4")&&d.seven&&!b.includes("6")},{name:"thirteen",check:b.includes("6")&&d.seven},{name:"add2",check:d.majorNinth&&d.third&&!d.seven&&!b.includes("6")},{name:"add4",check:d.third&&b.includes("4")&&!d.seven},{name:"add9",check:d.majorNinth&&d.third&&!d.seven},{name:"sus2",check:b.includes("2")&&!d.third},{name:"sus4",check:b.includes("4")&&!d.third&&!d.seven},{name:"sharp5",check:b.includes("#5")&&!b.some(function(a){return["5","3"].includes(a)})},{name:"flat5",check:b.includes("b5")&&!b.some(function(a){return["5"].includes(a)})},{name:"sharp11",check:["5","b5"].every(function(a){return b.includes(a)})&&d.seven},{name:"flat9",check:b.includes("b2")&&d.third},{name:"b6",check:b.includes("#5")&&b.includes("5")},{name:"doubleflat5",check:b.includes("4")&&d.third&&!d.fifth&&!d.seven}],f={add2:"add9",seven:"eleven",nine:"eleven",minor:"dim5",flat5:"dim5",major:"aug5"},g=e.filter(function(a){return a.check}).map(function(a){return a.name});return!!(0<g.length)&&(g=g.filter(function(a){return!g.includes(f[a])}),["six","add9"].every(function(a){return g.includes(a)})&&(g.splice(g.indexOf("six"),1),g[g.indexOf("add9")]="sixnine"),{semitones:a,formula:b,qualityS:g.map(function(a){return NAMING[a][0]}),qualityL:g.map(function(a){return NAMING[a][1]})})}function isValid$1(a){var b=/^[#a-g]+$/i;return!!b.test(a)}function parse$1(a){var b=[],c=/^[a-g]+$/i,d=/^[#a-g]+$/i;if(c.test(a))return a.toUpperCase().split("");if(d.test(a)){a=a.toUpperCase();for(var e=0;e<a.length;e++)"#"!==a.charAt(e)&&("#"===a.charAt(e+1)?(b.push(a.slice(e,e+2)),e++):b.push(a.slice(e,e+1)));return b}return!1}var GET={guitar:{standard:["E","A","D","G","B","E"],halfstepdown:["D#","G#","C#","F#","A#","D#"],drop_d:["D","A","D","G","B","E"],d_modal:["D","A","D","G","A","D"],open_g:["G","G","D","G","B","D"]},bass:{standard:["E","A","D","G"],drop_d:["C","A","D","G"]},ukulele:{standard:["G","C","E","A"]},violin:{standard:["G","D","A","E"]}};function dedupListOfLists(a){for(var b,c=[],d=[],e=0;e<a.length;e++)b=a[e].filter(function(a){return null!=a}).join(""),c.includes(b)?d.push(e):c.push(b);return d}function searchInObject(a,b){if("object"===_typeof(a)){"string"==typeof b&&(b=b.toLowerCase());for(var c=0;c<a.length;c++)for(var d in a[c]){if(a[c][d]===b)return a[c];if("string"==typeof a[c][d]&&a[c][d].toLowerCase()===b)return a[c]}throw"Couldn't find "+b+" in "+a}else throw a+" is not an object."}function arrayFind(a,b){var c=Math.max,d=Math.min,e=!1;if(!Array.isArray(a))throw a+" is not an array.";if("undefined"==typeof b)throw"Missing parameter.";switch(b){case"min":if(e=d.apply(Math,a),!isNaN(e))return e;for(var f=0;f<a.length;f++)if(isNaN(a[f]))continue;else if(isNaN(e)){e=a[f];continue}else if(a[f]<e)e=a[f];else continue;break;case"max":if(e=c.apply(Math,a),!isNaN(e))return e;for(var g=0;g<a.length;g++)if(isNaN(a[g]))continue;else if(isNaN(e)){e=a[g];continue}else if(a[g]>e)e=a[g];else continue;break;default:e=occurrences(a.join(""),b);}return e}function occurrences(a,b,c){if(a+="",b+="",0>=b.length)return a.length+1;for(var d=0,e=0,f=c?1:b.length;e=a.indexOf(b,e),0<=e;)++d,e+=f;return d}function isValid$2(a){var b=/^[x0-9]*$/i;return!!b.test(a)}function parse$2(a,b){a=a.toLowerCase(),b=b||"EADGBE";var c=[];if(a.length<=b.length)return a.split("");if(a.length===2*b.length){for(var d=0;d<a.length;d++)d%2||c.push(a.slice(d,d+2));return c}if(a.length>b.length){if(1<arrayFind(a.split(""),"max")){for(var e=0;e<a.length;e++)-1!==a.charAt(e).search(/[x02-9]/i)||1===a.charAt(e)&&-1!==a.charAt(e+1).search(/x/i)?c.push(a.slice(e,e+1)):-1===a.charAt(e+1).search(/x/i)&&(c.push(a.slice(e,e+2)),e++);return c}throw WORDING.invalidTab}else return!1}function toNotes(a,b){for(var c,d,e=[],f=0;f<a.length;f++)isNaN(a[f])?e.push("x"):(d=b[f],c=parseInt(a[f])+NOTES.indexOf(d),c>NOTES.length-1&&(c-=NOTES.length),e.push(NOTES[c]));return e}function getSemitones(a){for(var b,c=[],d=0;d<a.length;d++)if(b=[],a[d]&&"x"!==a[d].toLowerCase()){for(var e=0;e<a.length;e++){if(!a[e]||"x"===a[e].toLowerCase()){b.push(null);continue}var f=get(a[d],a[e]);b.push(f)}b.includes(0)&&c.push(b)}return c}/**Chordictionary v0.1.0-beta.4, @license MIT, (c) 2019 Hubert Fauconnier + contributors*/var Instrument=function(){var b=Math.max,c=Math.min;function a(b,c,d,e){_classCallCheck(this,a);try{if(isValid$1(b))this.tuning=parse$1(b);else throw WORDING.invalidTuning;this.fretNumber=c,this.fretsToDisplay=isNaN(d)?0:d+1,this.maxSpan=isNaN(e)?4:e}catch(a){return console.error(a),!1}return this}return _createClass(a,[{key:"getChordInfo",value:function(a){var b=[],c=[],d=[],f={error:"",tab:[],notes:"",tuning:this.tuning,chords:[]};try{if(isValid$2(a))a=parse$2(a),f.tab=a;else throw WORDING.invalidTab}catch(a){return f.error=a,f}try{b=toNotes(a,this.tuning),f.notes=_toConsumableArray(b)}catch(a){return f.error=WORDING.failedToConvertTabIntoNotes,f}try{c=getSemitones(b)}catch(a){return f.error=WORDING.failedToCalculateFormula,f}if(0<c.length){var g=dedupListOfLists(_toConsumableArray(c));c=c.filter(function(a,b){return!g.includes(b)})}else throw WORDING.noMatch;try{for(var h,j=0;j<c.length;j++)if(h=name(_toConsumableArray(c)[j]),h){var e=_toConsumableArray(new Set(c[j])).filter(function(a){return!isNaN(a)&&null!==a&&void 0!==a}).sort(function(c,a){return c-a}).map(function(a){return DIATONIC[a]});d.push({formula:e,semitones:h.semitones,quality:h.qualityL,suffix:h.qualityS})}}catch(a){return f.error=a,f}d.sort(function(c,a){return c.quality.length-a.quality.length});for(var k=0,l=d;k<l.length;k++){var m=l[k],n=m.semitones.map(function(a){return DIATONIC[a]}).map(function(a){return void 0===a?null:a}),o=b.filter(function(a){return"x"!==a})[0],p=b[m.semitones.indexOf(0)],q=p+m.suffix.join("");f.chords.push({name:p===o?q:q+"/"+o,pitch:p===o?p:p+"/"+o,formula:m.formula,intervals:n,semitones:m.semitones,notes:_toConsumableArray(b),quality:m.quality.join(" "),suffix:m.suffix.join("")})}return f}},{key:"getChordsList",value:function(a,b,c){var d=this;c=c||0;var e,f,g,h,j=[],k=[],l={error:"",chordList:[],offset:0},m={basic:{rootBelow4thFret:!0,noMuteAfterFirstNote:!0,rootIsLowestNote:!0,splittedChord:!1,openString:!0},powerchord:{frettedNotes:[2,3],rootIsLowestNote:!0,rootOnLowestFret:!0,splittedChord:!1,openString:!1},bar:{rootIsLowestNote:!0,rootOnLowestFret:!0,barredString:[3,6],noMuteAfterFirstNote:!0,splittedChord:!1,openString:!1}};try{if("string"==typeof a)a=parse(a),g=a[0],e=a[1],j.push(g),h=NOTES.indexOf(g);else throw WORDING.invalidChordName;f=searchInObject(FORMULAS,e),k=f.integer.split("-")}catch(a){return l.error=WORDING.invalidChordName,l}for(var n,o=1;o<k.length;o++)n=parseInt(k[o])+parseInt(h),n>NOTES.length-1&&(n-=NOTES.length),j.push(NOTES[n]);var p,q=[],r=0;for(r=0;r<this.tuning.length;r++){q[r]=[],q[r].push("x");for(var s=0;s<j.length;s++)p=NOTES.indexOf(j[s])-NOTES.indexOf(this.tuning[r]),0>p&&(p=NOTES.length+p),q[r].push(p),p+12<this.fretNumber&&q[r].push(p+12)}var t=[];for(r=0;r<this.tuning.length;r++)for(var u=t.length,v=0;v<q[r].length;v++)if(t[v]){for(var w=0;w<u;w++)if(0==v)t[w].push(q[r][v]);else{var x=t[w].slice(0);x.pop(),x.push(q[r][v]),t.push(x)}}else t[v]=[q[r][v]];var y=[],z=function(a,b){for(var c in a){if(!Object.prototype.hasOwnProperty.call(b,c))return!1;if("object"===_typeof(a[c])){var d=a[c][0],e=a[c][1];if(b[c]<d||b[c]>e)return!1}else if(b[c]!==a[c])return!1}return!0};try{for(var A=c;A<t.length;A++)if(isValid(t[A],j,this.tuning)&&arrayFind(t[A],"max")-arrayFind(t[A],"min")<this.maxSpan&&function(){var a={openString:!1,frettedNotes:0},b=t[A].join(""),c=/[0-9]+[x]+[0-9]+/gi,e=/[0-9]+[x]+/gi;a.splittedChord=!!c.test(b),a.noMuteAfterFirstNote=!e.test(b);for(var f,g=0;g<t[A].length;g++)if(f=t[A][g],!isNaN(f)){var i=f+NOTES.indexOf(d.tuning[g]);0===f&&(a.openString=!0),h===i&&(0===a.frettedNotes&&(a.rootIsLowestNote=!0),a.rootBelow4thFret=!!(4>=f),a.rootOnLowestFret=!!(arrayFind(t[A],"min")>=f)),(0<f&&g<t[A].length-1&&f===t[A][g-1]||3<=arrayFind(t[A],f))&&(a.barredString=isNaN(a.barredString)?1:a.barredString+1),a.frettedNotes++}var j={tab:t[A],tag:[]};Object.getOwnPropertyNames(m).forEach(function(b){z(m[b],a)&&j.tag.indexOf(b)&&j.tag.push(b)}),y.push(j)}(),0<b&&b<t[A].length&&y.length===b){c=A+1;break}}catch(a){console.error(a)}return l.chordList=y,l.offset=c,l}},{key:"getChordLayout",value:function(a,d){var f,g,e=Math.abs,h=this.fretsToDisplay;d="object"===_typeof(d)?d:{};try{f=isValid$2(a)?parse$2(a):[0,0,0,0,0,0]}catch(a){return!1}for(var j=d.notes?d.notes:f,k=d.name?d.name:f.join(" "),l=[],m=0;m<f.length;m++)!1===isNaN(f[m])&&l.push(f[m]);var n=e(b.apply(Math,l)),o=e(c.apply(Math,l)),p=1;n>=h&&(p=0<o?o:1),1===p&&5<n&&(p=n-h+2);try{if(0===h)h=n-p+2;else if(n-p+1>h-1)throw h=n-p+2,WORDING.croppedChordLayout}catch(a){console.error(a)}g="<table class=\"chord\">";for(var q,r=0;r<h;r++){q=r+p-1,1===p&&0==r&&(g+="<thead>"),g+=q%2&&0<q?"<tr><th class=\"fret-number\">"+q+"</th>":"<tr><th></th>";for(var s,t=0;t<this.tuning.length;t++)s=parseInt(f[t]),g+=0==r?0===s?"<th><div class=\"dot open\"></div></th>":"<th></th>":s===p+r-1?"<td><div class=\"dot plain\">"+j[t]+"</div></td>":"<td></td>";g+=1===p&&0==r?"<tr></thead>":"</tr>"}return g+="<caption align=\"bottom\">"+k+"</caption>",g+="</table>",g}}]),a}(),isValidTab=isValid$2,isValidTuning=isValid$1,parseTuning=parse$1,parseTab=parse$2,parseChord=parse,tuning=GET,notes=NOTES;exports.Instrument=Instrument,exports.isValidTab=isValidTab,exports.isValidTuning=isValidTuning,exports.parseTuning=parseTuning,exports.parseTab=parseTab,exports.parseChord=parseChord,exports.tuning=tuning,exports.notes=notes;