/**Chordictionary v0.1.0-alpha.0, @license MIT, (c) 2016 Hubert Fauconnier + contributors*/
!function(t){"use strict";function r(){function t(t,r,e){for(var n,o,a={},i=0;i<t.length;i++)if(!isNaN(t[i])){o=t[i]+h.indexOf(e[i]),o>h.length-1&&(o-=h.length);for(var f=0;f<r.length;f++)a[h[o]]?h[o]==h[f]&&a[h[o]]++:a[h[o]]=1}for(var f=0;f<r.length;f++){if(!(r[f]in a)){n=!1;break}n=!0}return n}function r(t,r){r=r||"EADGBE";var e=[];try{if(t.length<=r.length)return t.split("");if(t.length==2*r.length){for(var n=0;n<t.length;n++)n%2||e.push(t.slice(n,n+2));return e}if(t.length>r.length){if(i(t.split(""),"max")>1){for(var n=0;n<t.length;n++)-1!=t.charAt(n).search(/[x02-9]/i)||1==t.charAt(n)&&-1!=t.charAt(n+1).search(/x/i)?e.push(t.slice(n,n+1)):-1==t.charAt(n+1).search(/x/i)&&(e.push(t.slice(n,n+2)),n++);return e}throw s.invalidTab}}catch(o){return!1}}function e(t){var r=[],e=new RegExp("^[a-g]+$","i"),n=new RegExp("^[#a-g]+$","i");try{if(e.test(t))return t.toUpperCase().split("");if(n.test(t)){t=t.toUpperCase();for(var o=0;o<t.length;o++)"#"!=t.charAt(o)&&("#"!=t.charAt(o+1)?r.push(t.slice(o,o+1)):(r.push(t.slice(o,o+2)),o++));return r}throw s.invalidTuning}catch(a){return!1}}function n(t){var r,e;try{if("string"!=typeof t)throw s.invalidChordName;var n=t.search("#");return-1==n?(r=t.charAt(0),e=t.slice(1)):(r=t.slice(0,2).toUpperCase(),e=t.slice(2)),[r,e]}catch(o){return!1}}function o(t){try{if(Array.isArray(t))return t.filter(function(t,r,e){return r==e.indexOf(t)});throw t+" is not an array."}catch(r){return!1}}function a(t,r){try{if("object"==typeof t){"string"==typeof r&&(r=r.toLowerCase());for(var e=0;e<t.length;e++)for(var n in t[e]){if(t[e][n]==r)return t[e];if("string"==typeof t[e][n]&&t[e][n].toLowerCase()==r)return t[e]}throw"Couldn't find "+r+" in "+t}throw t+" is not an object."}catch(o){return!1}}function i(t,r){var e;try{if(!Array.isArray(t))throw t+" is not an array.";if(!r)throw"Missing parameter.";switch(r){case"min":if(e=Math.min.apply(Math,t),!isNaN(e))return e;for(var n=0;n<t.length;n++)isNaN(t[n])||(isNaN(e)?e=t[n]:t[n]<e&&(e=t[n]));break;case"max":if(e=Math.max.apply(Math,t),!isNaN(e))return e;for(var n=0;n<t.length;n++)isNaN(t[n])||(isNaN(e)?e=t[n]:t[n]>e&&(e=t[n]));break;default:e=f(t.join(""),r)}}catch(o){return!1}return e}function f(t,r,e){if(t+="",r+="",r.length<=0)return t.length+1;for(var n=0,o=0,a=e?1:r.length;;){if(o=t.indexOf(r,o),!(o>=0))break;++n,o+=a}return n}var s={croppedChordLayout:"Number of frets does not allow full display of the chord.",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",invalidTab:'The tab should only be composed of "x" and numbers from 1 to 9.',invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",noMatch:"The tab didn't match any known chord."},h=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],u=[{formula:"1-3-5",integer:"0-4-7",name:"Major",suffix:""},{formula:"1-5",integer:"0-7",name:"Power chord",suffix:"5"},{formula:"1-4-5",integer:"0-5-7",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"0-2-7",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"0-4-7-14",name:"Added ninth",suffix:"add9"},{formula:"1-3-5-6",integer:"0-4-7-9",name:"Major Sixth",suffix:"6"},{formula:"1-3-5-6-9",integer:"0-4-7-9-14",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7",integer:"0-4-7-11",name:"Major seventh",suffix:"maj7"},{formula:"1-3-5-7-9",integer:"0-4-7-11-14",name:"Major ninth",suffix:"maj9"},{formula:"1-3-5-7-#11",integer:"0-4-7-11-18",name:"Major seventh, sharp eleventh",suffix:"maj7#11"},{formula:"1-3-5-7-9-13",integer:"0-4-7-11-14-21",name:"Major thirteen",suffix:"Maj13"},{formula:"1-b3-5",integer:"0-3-7",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"0-3-7-14",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-b3-5-6",integer:"0-3-7-9",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0-3-7-8",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"0-3-7-9-14",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-b3-5-b7",integer:"0-3-7-10",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-5-7",integer:"0-3-7-11",name:"Minor, major seventh",suffix:"m(maj7)"},{formula:"1-b3-5-b7",integer:"0-3-6-10",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-b3-5-b7-9",integer:"0-3-7-10-14",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0-3-7-11-14",name:"Minor ninth, major seventh",suffix:"m9(maj7)"},{formula:"1-b3-b5-b7-9",integer:"0-3-7-10-14",name:"Minor eleventh",suffix:"m9b5"},{formula:"1-b3-5-b7-9-11-13",integer:"0-3-7-10-14-17-21",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-b7",integer:"0-4-7-10",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5#",integer:"0-4-8",name:"Augmented",suffix:"aug"},{formula:"1-3-b5",integer:"0-4-6",name:"Diminished",suffix:"dim"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-3-b7",integer:"0-4-10",name:"Seventh",suffix:"7"},{formula:"1-3-6",integer:"0-4-9",name:"Sixth",suffix:"6"}],l={};return l.Instrument=function(t,r,n,o){try{l.isValidTuning(t)&&(this.tuning=e(t)),this.fretNumber=r,this.fretsToDisplay=isNaN(n)?0:n+1,this.maxSpan=isNaN(o)?4:o}catch(a){return console.error(a),!1}return this},l.Instrument.prototype.getChordInfo=function(t){var e=[],n=[],a=[],i={error:"",name:"",tab:t,notes:"",tuning:this.tuning.join(""),formula:""};try{l.isValidTab(t)&&(t=r(t))}catch(f){return i.error=f,i}var d,g;try{for(var m=0;m<t.length;m++)isNaN(t[m])?e.push("x"):(g=this.tuning[m],d=parseInt(t[m])+h.indexOf(g),d>h.length-1&&(d-=h.length),e.push(h[d]));i.notes=e.join("")}catch(f){return i.error=s.failedToConvertTabIntoNotes,i}var c=[];try{for(var m=0;m<this.tuning.length;m++)if(c.push({root:"",formula:[]}),e[m]&&"x"!=e[m])for(var p=0;p<e.length;p++)if(e[p]&&"x"!=e[p]){var v=h.indexOf(e[p])-h.indexOf(e[m]);0>v?v=h.length+v:0===v&&(c[m].root=e[p]),c[m].formula.push(v)}}catch(f){i.error=s.failedToCalculateFormula}for(var m=0;m<c.length;m++)if(""!==c[m].root){a.push(c[m].root),c[m].formula.sort(function(t,r){return t-r});var x=o(c[m].formula);n.push(x.join("-"))}var b,y,w=[],N=[];try{for(var m=0;m<u.length;m++){b=u[m].integer;for(var p=0;p<n.length;p++)y=new RegExp("^"+n[p]+"$","g"),b.match(y)&&a[p]&&(N.push(a[p]+u[m].suffix),w.push(u[m].formula))}if(!(w.length>0))throw s.noMatch;if(w.length>1){var M=o(w);i.formula=M}else i.formula=w}catch(f){return i.error=f,i}if(N.length>1){var C=o(N);i.name=C}else i.name=N;return i},l.Instrument.prototype.getChordsList=function(r,e,o){var f,l,d=[],o=o||0,g=[],m={error:"",chordList:[],offset:0};try{if("string"!=typeof r)throw s.invalidChordName;var r=n(r);l=r[0],f=r[1],d.push(l)}catch(c){return m.error=c,m}try{var p=a(u,f);g=p.integer.split("-")}catch(c){return m.error=c,m}for(var v=1;v<g.length;v++){var x=parseInt(g[v])+parseInt(h.indexOf(l));x>h.length-1&&(x-=h.length),d.push(h[x])}for(var b,y=[],w=0;w<this.tuning.length;w++){y[w]=[],y[w].push("x");for(var N=0;N<d.length;N++)b=h.indexOf(d[N])-h.indexOf(this.tuning[w]),0>b&&(b=h.length+b),y[w].push(b),b+12<this.fretNumber&&y[w].push(b+12)}for(var M=[],w=0;w<this.tuning.length;w++)for(var C=M.length,v=0;v<y[w].length;v++)if(M[v])for(var O=0;C>O;O++)if(0===v)M[O].push(y[w][v]);else{var A=M[O].slice(0);A.pop(),A.push(y[w][v]),M.push(A)}else M[v]=[y[w][v]];for(var T=[],j=o;j<M.length;j++){var I={rootBelow4thFret:!1,rootIsLowestNote:!1,rootOnLowestFret:!1,noMuteAfterRoot:!1,openString:0,barredString:0,frettedNotes:0,splittedChord:!1};if(t(M[j],d,this.tuning)&&i(M[j],"max")-i(M[j],"min")<this.maxSpan){for(var v=0;v<M[j].length;v++)if(isNaN(M[j][v]))v>0&&v<M[j].length-1&&("x"!=M[j][v+1]&&"x"!=M[j][v-1]||M[j].lastIndexOf("x")>0&&M[j].lastIndexOf("x")<M[j].length-1)&&(I.splittedChord=!0);else{var L=M[j][v]+h.indexOf(this.tuning[v]);h.indexOf(l)==L&&(0===I.frettedNotes&&(I.rootIsLowestNote=!0,M[j][v]<=4&&(I.rootBelow4thFret=!0,M[j].lastIndexOf("x")<v&&(I.noMuteAfterRoot=!0))),i(M[j],"min")>=M[j][v]&&(I.rootOnLowestFret=!0)),0===M[j][v]&&I.openString++,(M[j][v]>0&&v<M[j].length-1&&M[j][v]===M[j][v-1]||i(M[j],M[j][v])>=3)&&I.barredString++,I.frettedNotes++}try{var S=T.length,F=[];T.push({tab:M[j],tag:[]}),I.rootBelow4thFret&&I.noMuteAfterRoot&&I.rootIsLowestNote&&(I.barredString>=1?I.rootOnLowestFret&&(F.indexOf("basic")&&F.push("basic"),F.indexOf("bar")&&F.push("bar")):F.indexOf("basic")&&F.push("basic")),!I.noMuteAfterRoot&&I.frettedNotes<=3&&I.rootIsLowestNote&&I.rootOnLowestFret&&!I.splittedChord&&!I.openString&&F.indexOf("powerchord")&&F.push("powerchord"),I.rootIsLowestNote&&I.rootOnLowestFret&&I.barredString>=1&&!I.splittedChord&&!I.openString&&F.indexOf("bar")&&F.push("bar"),F.length&&(T[S].tag=F.join(", "))}catch(c){console.error(c)}if(e>0&&e<M[j].length&&T.length>=e){o=j+1;break}}}return m.chordList=T,m.offset=o,m},l.Instrument.prototype.getChordLayout=function(t,e){var n,o,a=this.fretsToDisplay;try{n=l.isValidTab(e)?r(e):[0,0,0,0,0,0]}catch(i){return!1}for(var f=[],h=0;h<n.length;h++)isNaN(n[h])===!1&&f.push(n[h]);var u=Math.abs(Math.max.apply(Math,f)),d=Math.abs(Math.min.apply(Math,f)),g=1;u>=a&&(g=d>0?d:1),1===g&&u>5&&(g=u-a+2);try{if(0===a)a=u-g+2;else if(u-g+1>a-1)throw a=u-g+2,s.croppedChordLayout}catch(i){console.error(i)}o='<table class="chord">';for(var m=0;a>m;m++){var c=m+g-1;1==g&&0===m&&(o+="<thead>"),o+=c%2&&c>0?'<tr><th class="fret-number">'+c+"</th>":"<tr><th></th>";for(var p=0;p<this.tuning.length;p++)o+=0===m?0===n[p]?'<th><div class="dot open"></div></th>':"<th></th>":n[p]==g+m-1?'<td><div class="dot plain">'+n[p]+"</div></td>":"<td></td>";o+=1==g&&0===m?"<tr></thead>":"</tr>"}return o+='<caption align="bottom">'+t+"</caption>",o+="</table>"},l.isValidTab=function(t){var r=new RegExp("^[x0-9]*$","i");if(r.test(t))return!0;throw s.invalidTab},l.isValidTuning=function(t){var r=new RegExp("^[#a-g]+$","i");if(r.test(t))return!0;throw s.invalidTuning},l}"undefined"==typeof Chordictionary?t.Chordictionary=r():console.error("Chordictionary is already defined.")}(window);