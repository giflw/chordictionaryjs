/**Chordictionary v0.1.0-alpha.2, @license MIT, (c) 2016 Hubert Fauconnier + contributors*/
!function(t){"use strict";function e(){function t(t,e,r){for(var n,i,o,a={},s=0;s<t.length;s++)if(!isNaN(t[s]))for(i=t[s]+h.indexOf(r[s]),i>h.length-1&&(i-=h.length),o=0;o<e.length;o++)a[h[i]]?h[i]==h[o]&&a[h[i]]++:a[h[i]]=1;for(o=0;o<e.length;o++){if(!(e[o]in a)){n=!1;break}n=!0}return n}function e(t,e){e=e||"EADGBE";var r=[];if(t.length<=e.length)return t.split("");if(t.length==2*e.length){for(var n=0;n<t.length;n++)n%2||r.push(t.slice(n,n+2));return r}if(t.length>e.length){if(a(t.split(""),"max")>1){for(var n=0;n<t.length;n++)-1!=t.charAt(n).search(/[x02-9]/i)||1==t.charAt(n)&&-1!=t.charAt(n+1).search(/x/i)?r.push(t.slice(n,n+1)):-1==t.charAt(n+1).search(/x/i)&&(r.push(t.slice(n,n+2)),n++);return r}throw f.invalidTab}return!1}function r(t){var e=[],r=new RegExp("^[a-g]+$","i"),n=new RegExp("^[#a-g]+$","i");if(r.test(t))return t.toUpperCase().split("");if(n.test(t)){t=t.toUpperCase();for(var i=0;i<t.length;i++)"#"!=t.charAt(i)&&("#"!=t.charAt(i+1)?e.push(t.slice(i,i+1)):(e.push(t.slice(i,i+2)),i++));return e}throw f.invalidTuning}function n(t){var e,r;try{if("string"!=typeof t)throw f.invalidChordName;var n=t.search("#");return-1==n?(e=t.charAt(0),r=t.slice(1)):(e=t.slice(0,2).toUpperCase(),r=t.slice(2)),[e,r]}catch(i){return!1}}function i(t){if(Array.isArray(t))return t.filter(function(t,e,r){return e==r.indexOf(t)});throw t+" is not an array."}function o(t,e){if("object"==typeof t){"string"==typeof e&&(e=e.toLowerCase());for(var r=0;r<t.length;r++)for(var n in t[r]){if(t[r][n]==e)return t[r];if("string"==typeof t[r][n]&&t[r][n].toLowerCase()==e)return t[r]}throw"Couldn't find "+e+" in "+t}throw t+" is not an object."}function a(t,e){var r=!1;if(!Array.isArray(t))throw t+" is not an array.";if("undefined"==typeof e)throw"Missing parameter.";switch(e){case"min":if(r=Math.min.apply(Math,t),!isNaN(r))return r;for(var n=0;n<t.length;n++)isNaN(t[n])||(isNaN(r)?r=t[n]:t[n]<r&&(r=t[n]));break;case"max":if(r=Math.max.apply(Math,t),!isNaN(r))return r;for(var n=0;n<t.length;n++)isNaN(t[n])||(isNaN(r)?r=t[n]:t[n]>r&&(r=t[n]));break;default:r=s(t.join(""),e)}return r}function s(t,e,r){if(t+="",e+="",e.length<=0)return t.length+1;for(var n=0,i=0,o=r?1:e.length;;){if(i=t.indexOf(e,i),!(i>=0))break;++n,i+=o}return n}var f={croppedChordLayout:"Number of frets does not allow full display of the chord.",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",invalidTab:'The tab should only be composed of "x" and numbers from 1 to 9.',invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",noMatch:"The tab didn't match any known chord."},h=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],u=[{formula:"1-3-5",integer:"0-4-7",name:"Major",suffix:""},{formula:"1-5",integer:"0-7",name:"Power chord",suffix:"5"},{formula:"1-4-5",integer:"0-5-7",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"0-2-7",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"0-4-7-14",name:"Added ninth",suffix:"add9"},{formula:"1-3-5-6",integer:"0-4-7-9",name:"Major Sixth",suffix:"6"},{formula:"1-3-5-6-9",integer:"0-4-7-9-14",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7",integer:"0-4-7-11",name:"Major seventh",suffix:"maj7"},{formula:"1-3-5-7-9",integer:"0-4-7-11-14",name:"Major ninth",suffix:"maj9"},{formula:"1-3-5-7-#11",integer:"0-4-7-11-18",name:"Major seventh, sharp eleventh",suffix:"maj7#11"},{formula:"1-3-5-7-9-13",integer:"0-4-7-11-14-21",name:"Major thirteen",suffix:"Maj13"},{formula:"1-b3-5",integer:"0-3-7",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"0-3-7-14",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-b3-5-6",integer:"0-3-7-9",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0-3-7-8",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"0-3-7-9-14",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-b3-5-b7",integer:"0-3-7-10",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-5-7",integer:"0-3-7-11",name:"Minor, major seventh",suffix:"m(maj7)"},{formula:"1-b3-5-b7",integer:"0-3-6-10",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-b3-5-b7-9",integer:"0-3-7-10-14",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0-3-7-11-14",name:"Minor ninth, major seventh",suffix:"m9(maj7)"},{formula:"1-b3-b5-b7-9",integer:"0-3-7-10-14",name:"Minor eleventh",suffix:"m9b5"},{formula:"1-b3-5-b7-9-11-13",integer:"0-3-7-10-14-17-21",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-b7",integer:"0-4-7-10",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5#",integer:"0-4-8",name:"Augmented",suffix:"aug"},{formula:"1-3-b5",integer:"0-4-6",name:"Diminished",suffix:"dim"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-3-b7",integer:"0-4-10",name:"Seventh",suffix:"7"},{formula:"1-3-6",integer:"0-4-9",name:"Sixth",suffix:"6"}],l={};return l.Instrument=function(t,e,n,i){try{l.isValidTuning(t)&&(this.tuning=r(t)),this.fretNumber=e,this.fretsToDisplay=isNaN(n)?0:n+1,this.maxSpan=isNaN(i)?4:i}catch(o){return console.error(o),!1}return this},l.Instrument.prototype.getChordInfo=function(t){var r=[],n=[],o=[],a={error:"",name:"",tab:t,notes:"",tuning:this.tuning.join(""),formula:""};try{l.isValidTab(t)&&(t=e(t))}catch(s){return a.error=s,a}var d,m;try{for(var g=0;g<t.length;g++)isNaN(t[g])?r.push("x"):(m=this.tuning[g],d=parseInt(t[g])+h.indexOf(m),d>h.length-1&&(d-=h.length),r.push(h[d]));a.notes=r.join("")}catch(s){return a.error=f.failedToConvertTabIntoNotes,a}var c=[];try{for(var g=0;g<this.tuning.length;g++)if(c.push({root:"",formula:[]}),r[g]&&"x"!=r[g])for(var p=0;p<r.length;p++)if(r[p]&&"x"!=r[p]){var v=h.indexOf(r[p])-h.indexOf(r[g]);0>v?v=h.length+v:0===v&&(c[g].root=r[p]),c[g].formula.push(v)}}catch(s){a.error=f.failedToCalculateFormula}for(var g=0;g<c.length;g++)if(""!==c[g].root){o.push(c[g].root),c[g].formula.sort(function(t,e){return t-e});var x=i(c[g].formula);n.push(x.join("-"))}var b,N,y=[],w=[];try{for(var g=0;g<u.length;g++){b=u[g].integer;for(var p=0;p<n.length;p++)N=new RegExp("^"+n[p]+"$","g"),b.match(N)&&o[p]&&(w.push(o[p]+u[g].suffix),y.push(u[g].formula))}if(!(y.length>0))throw f.noMatch;if(y.length>1){var M=i(y);a.formula=M}else a.formula=y}catch(s){return a.error=s,a}if(w.length>1){var C=i(w);a.name=C}else a.name=w;return a},l.Instrument.prototype.getChordsList=function(e,r,i){i=i||0;var s,l,d,m=[],g=[],c={error:"",chordList:[],offset:0};try{if("string"!=typeof e)throw f.invalidChordName;e=n(e),l=e[0],s=e[1],m.push(l),d=h.indexOf(l);var p=o(u,s);g=p.integer.split("-")}catch(v){return c.error=f.invalidChordName,c}for(var x=1;x<g.length;x++){var b=parseInt(g[x])+parseInt(d);b>h.length-1&&(b-=h.length),m.push(h[b])}for(var N,y=[],w=0;w<this.tuning.length;w++){y[w]=[],y[w].push("x");for(var M=0;M<m.length;M++)N=h.indexOf(m[M])-h.indexOf(this.tuning[w]),0>N&&(N=h.length+N),y[w].push(N),N+12<this.fretNumber&&y[w].push(N+12)}var C=[];for(w=0;w<this.tuning.length;w++)for(var A=C.length,x=0;x<y[w].length;x++)if(C[x])for(var T=0;A>T;T++)if(0===x)C[T].push(y[w][x]);else{var O=C[T].slice(0);O.pop(),O.push(y[w][x]),C.push(O)}else C[x]=[y[w][x]];try{for(var j=[],I=i;I<C.length;I++){var L={rootBelow4thFret:!1,rootIsLowestNote:!1,rootOnLowestFret:!1,noMuteAfterFirstNote:!1,openString:!1,barredString:0,frettedNotes:0,splittedChord:!1};if(t(C[I],m,this.tuning)&&a(C[I],"max")-a(C[I],"min")<this.maxSpan){for(var x=0;x<C[I].length;x++)if(isNaN(C[I][x]))x>0&&x<C[I].length-1&&("x"!=C[I][x+1]&&"x"!=C[I][x-1]||C[I].lastIndexOf("x")>0&&C[I].lastIndexOf("x")<C[I].length-1)&&(L.splittedChord=!0);else{var F=C[I][x]+h.indexOf(this.tuning[x]);d==F&&(0===L.frettedNotes&&(L.rootIsLowestNote=!0),C[I][x]<=4&&(L.rootBelow4thFret=!0),a(C[I],"min")>=C[I][x]&&(L.rootOnLowestFret=!0)),C[I].lastIndexOf("x")<x&&(L.noMuteAfterFirstNote=!0),0===C[I][x]&&(L.openString=!0),(C[I][x]>0&&x<C[I].length-1&&C[I][x]===C[I][x-1]||a(C[I],C[I][x])>=3)&&L.barredString++,L.frettedNotes++}var S=j.length,E=[];j.push({tab:C[I],tag:[]}),L.rootBelow4thFret&&L.noMuteAfterFirstNote&&L.rootIsLowestNote&&!L.splittedChord&&(L.barredString>=1?L.rootOnLowestFret&&E.indexOf("basic")&&E.push("basic"):E.indexOf("basic")&&E.push("basic")),!L.noMuteAfterFirstNote&&L.frettedNotes<=3&&L.rootIsLowestNote&&L.rootOnLowestFret&&!L.splittedChord&&!L.openString&&E.indexOf("powerchord")&&E.push("powerchord"),L.rootIsLowestNote&&L.rootOnLowestFret&&L.barredString>=1&&L.noMuteAfterFirstNote&&!L.splittedChord&&!L.openString&&E.indexOf("bar")&&E.push("bar"),E.length&&(j[S].tag=E)}if(r>0&&r<C[I].length&&j.length>=r){i=I+1;break}}}catch(v){console.error(v)}return c.chordList=j,c.offset=i,c},l.Instrument.prototype.getChordLayout=function(t,r){var n,i,o=this.fretsToDisplay;try{n=l.isValidTab(r)?e(r):[0,0,0,0,0,0]}catch(a){return!1}for(var s=[],h=0;h<n.length;h++)isNaN(n[h])===!1&&s.push(n[h]);var u=Math.abs(Math.max.apply(Math,s)),d=Math.abs(Math.min.apply(Math,s)),m=1;u>=o&&(m=d>0?d:1),1===m&&u>5&&(m=u-o+2);try{if(0===o)o=u-m+2;else if(u-m+1>o-1)throw o=u-m+2,f.croppedChordLayout}catch(a){console.error(a)}i='<table class="chord">';for(var g=0;o>g;g++){var c=g+m-1;1==m&&0===g&&(i+="<thead>"),i+=c%2&&c>0?'<tr><th class="fret-number">'+c+"</th>":"<tr><th></th>";for(var p=0;p<this.tuning.length;p++)i+=0===g?0===n[p]?'<th><div class="dot open"></div></th>':"<th></th>":n[p]==m+g-1?'<td><div class="dot plain">'+n[p]+"</div></td>":"<td></td>";i+=1==m&&0===g?"<tr></thead>":"</tr>"}return i+='<caption align="bottom">'+t+"</caption>",i+="</table>"},l.isValidTab=function(t){var e=new RegExp("^[x0-9]*$","i");if(e.test(t))return!0;throw f.invalidTab},l.isValidTuning=function(t){var e=new RegExp("^[#a-g]+$","i");if(e.test(t))return!0;throw f.invalidTuning},l}"undefined"==typeof Chordictionary?t.Chordictionary=e():console.error("Chordictionary is already defined.")}(window);