"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}var chordictionary=function(a){'use strict';var l=Math.max,m=Math.min;function b(a,b,c){for(var d,e,f={},g=0;g<a.length;g++)if(!isNaN(a[g])){e=a[g]+o.indexOf(c[g]),e>o.length-1&&(e-=o.length);for(var h=0;h<b.length;h++)f[o[e]]?o[e]===o[h]&&f[o[e]]++:f[o[e]]=1}for(var k=0;k<b.length;k++)if(b[k]in f)d=!0;else{d=!1;break}return d}function c(a){var b=/^[#a-g]+$/i;if(b.test(a))return!0;throw n.invalidTuning}function d(a){var b=/^[x0-9]*$/i;if(b.test(a))return!0;throw n.invalidTab}function e(a){if(!Array.isArray(a))throw a+" is not an array.";else return a.filter(function(a,b,c){return b===c.indexOf(a)})}function f(a,b){if("object"===_typeof(a)){"string"==typeof b&&(b=b.toLowerCase());for(var c=0;c<a.length;c++)for(var d in a[c]){if(a[c][d]===b)return a[c];if("string"==typeof a[c][d]&&a[c][d].toLowerCase()===b)return a[c]}throw"Couldn't find "+b+" in "+a}else throw a+" is not an object."}function g(a,b){var c=!1;if(!Array.isArray(a))throw a+" is not an array.";if("undefined"==typeof b)throw"Missing parameter.";switch(b){case"min":if(c=m.apply(Math,a),!isNaN(c))return c;for(var d=0;d<a.length;d++)if(isNaN(a[d]))continue;else if(isNaN(c)){c=a[d];continue}else if(a[d]<c)c=a[d];else continue;break;case"max":if(c=l.apply(Math,a),!isNaN(c))return c;for(var e=0;e<a.length;e++)if(isNaN(a[e]))continue;else if(isNaN(c)){c=a[e];continue}else if(a[e]>c)c=a[e];else continue;break;default:c=h(a.join(""),b);}return c}function h(a,b,c){if(a+="",b+="",0>=b.length)return a.length+1;for(var d=0,e=0,f=c?1:b.length;e=a.indexOf(b,e),0<=e;)++d,e+=f;return d}function i(a){var b=[],c=/^[a-g]+$/i,d=/^[#a-g]+$/i;if(c.test(a))return a.toUpperCase().split("");if(d.test(a)){a=a.toUpperCase();for(var e=0;e<a.length;e++)"#"!==a.charAt(e)&&("#"===a.charAt(e+1)?(b.push(a.slice(e,e+2)),e++):b.push(a.slice(e,e+1)));return b}throw n.invalidTuning}function j(a){var b,c;try{if("string"!=typeof a)throw n.invalidChordName;else{var d=a.search("#");return-1===d?(b=a.charAt(0),c=a.slice(1)):(b=a.slice(0,2).toUpperCase(),c=a.slice(2)),[b,c]}}catch(a){return!1}}function k(a,b){a=a.toLowerCase(),b=b||"EADGBE";var c=[];if(a.length<=b.length)return a.split("");if(a.length===2*b.length){for(var d=0;d<a.length;d++)d%2||c.push(a.slice(d,d+2));return c}if(a.length>b.length){if(1<g(a.split(""),"max")){for(var e=0;e<a.length;e++)-1!==a.charAt(e).search(/[x02-9]/i)||1===a.charAt(e)&&-1!==a.charAt(e+1).search(/x/i)?c.push(a.slice(e,e+1)):-1===a.charAt(e+1).search(/x/i)&&(c.push(a.slice(e,e+2)),e++);return c}throw n.invalidTab}else return!1}/**Chordictionary v0.1.0-alpha.2, @license MIT, (c) 2016 Hubert Fauconnier + contributors*/var n={croppedChordLayout:"Number of frets does not allow full display of the chord.",failedToConvertTabIntoNotes:"Could not convert the tab into notes.",failedToCalculateFormula:"Could not calculate the formulas.",invalidTab:"The tab should only be composed of \"x\" and numbers from 1 to 9.",invalidTuning:"The tuning doesn't seem right. It should only be composed of 1 or more letters from A to G.",invalidChordName:"The chord name doesn't seem right. A valid chord name could be Amin, C, Gsus4...",noMatch:"The tab didn't match any known chord."},o=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],p=[{formula:"1-3-5",integer:"0-4-7",name:"Major",suffix:""},{formula:"1-3-5#",integer:"0-4-8",name:"Augmented",suffix:"aug"},{formula:"1-b3-b5",integer:"0-3-6",name:"Diminished",suffix:"dim"},{formula:"1-b3-5",integer:"0-3-7",name:"Minor",suffix:"min"},{formula:"1-b3-5-9",integer:"0-2-3-7",name:"Minor, added ninth",suffix:"m(add9)"},{formula:"1-4-5",integer:"0-5-7",name:"Suspended fourth",suffix:"sus4"},{formula:"1-2-5",integer:"0-2-7",name:"Suspended second",suffix:"sus2"},{formula:"1-3-5-9",integer:"0-2-4-7",name:"Added ninth",suffix:"add9"},{formula:"1-3-b7",integer:"0-4-10",name:"Seventh",suffix:"7"},{formula:"1-3-5-b7",integer:"0-4-7-10",name:"Dominant seventh",suffix:"7"},{formula:"1-3-5-7",integer:"0-4-7-11",name:"Major seventh",suffix:"maj7"},{formula:"1-b3-5-7",integer:"0-3-7-11",name:"Minor, major seventh",suffix:"m(maj7)"},{formula:"1-b3-5-b7",integer:"0-3-7-10",name:"Minor seventh",suffix:"m7"},{formula:"1-b3-b5-b7",integer:"0-3-6-10",name:"Minor seventh, flat fifth",suffix:"m7b5"},{formula:"1-3-6",integer:"0-4-9",name:"Sixth",suffix:"6"},{formula:"1-b3-5-6",integer:"0-3-7-9",name:"Minor sixth",suffix:"m6"},{formula:"1-b3-5-b6",integer:"0-3-7-8",name:"Minor, flat sixth",suffix:"mb6"},{formula:"1-b3-5-6-9",integer:"0-2-3-7-9",name:"Minor sixth, added ninth",suffix:"m6/9"},{formula:"1-3-5-6",integer:"0-4-7-9",name:"Major Sixth",suffix:"maj6"},{formula:"1-3-5-6-9",integer:"0-2-4-7-9",name:"Sixth, added ninth",suffix:"6/9"},{formula:"1-3-5-7-9",integer:"0-2-4-7-11",name:"Major ninth",suffix:"maj9"},{formula:"1-b3-5-b7-9",integer:"0-2-3-7-10",name:"Minor ninth",suffix:"m9"},{formula:"1-b3-5-7-9",integer:"0-2-3-7-11",name:"Minor ninth, major seventh",suffix:"m9(maj7)"},{formula:"1-b3-b5-b7-9",integer:"0-2-3-6-10",name:"Minor eleventh",suffix:"m9b5"},{formula:"1-b3-5-b7-9-11-13",integer:"0-2-3-4-6-7-10",name:"Minor thirteen",suffix:"m13"},{formula:"1-3-5-7-#11",integer:"0-4-7-11-18",name:"Major seventh, sharp eleventh",suffix:"maj7#11"},{formula:"1-3-5-7-9-13",integer:"0-2-4-7-9-11",name:"Major thirteen",suffix:"maj13"},{formula:"1",integer:"0",name:"Single note",suffix:""},{formula:"1-5",integer:"0-7",name:"Power chord",suffix:"5"}],q=function(){function a(b,d,e,f){_classCallCheck(this,a);try{c(b)&&(this.tuning=i(b)),this.fretNumber=d,this.fretsToDisplay=isNaN(e)?0:e+1,this.maxSpan=isNaN(f)?4:f}catch(a){return console.error(a),!1}return this}return _createClass(a,[{key:"getChordInfo",value:function(a){var b=[],c=[],f=[],g={error:"",name:"",tab:a,notes:"",tuning:this.tuning.join(""),formula:""};try{d(a)&&(a=k(a))}catch(a){return g.error=a,g}var h,l;try{for(var m=0;m<a.length;m++)isNaN(a[m])?b.push("x"):(l=this.tuning[m],h=parseInt(a[m])+o.indexOf(l),h>o.length-1&&(h-=o.length),b.push(o[h]));g.notes=b.join("")}catch(a){return g.error=n.failedToConvertTabIntoNotes,g}var q=[];try{for(var r=0;r<this.tuning.length;r++)if(q.push({root:"",formula:[]}),b[r]&&"x"!==b[r].toLowerCase())for(var s=0;s<b.length;s++)if(b[s]&&"x"!==b[s].toLowerCase()){var t=o.indexOf(b[s])-o.indexOf(b[r]);0>t?t=o.length+t:0==t&&(q[r].root=b[s]),q[r].formula.push(t)}}catch(a){g.error=n.failedToCalculateFormula}for(var u=0;u<q.length;u++)if(""!==q[u].root){f.push(q[u].root),q[u].formula.sort(function(c,a){return c-a});var v=e(q[u].formula);c.push(v.join("-"))}var w,x,y=[],z=[];try{for(var A=0;A<p.length;A++){w=p[A].integer;for(var B=0;B<c.length;B++)x=new RegExp("^"+c[B]+"$","g"),w.match(x)&&f[B]&&(z.push(f[B]+p[A].suffix),y.push(p[A].formula))}if(!(0<y.length))throw n.noMatch;else if(1<y.length){var C=e(y);g.formula=C}else g.formula=y}catch(a){return g.error=a,g}if(1<z.length){var D=e(z);g.name=D}else g.name=z;return g}},{key:"getChordsList",value:function(a,c,d){var e=this;d=d||0;var h,k,l,m,q=[],r=[],s={error:"",chordList:[],offset:0},t={basic:{rootBelow4thFret:!0,noMuteAfterFirstNote:!0,rootIsLowestNote:!0,splittedChord:!1,openString:!0},powerchord:{frettedNotes:[2,3],rootIsLowestNote:!0,rootOnLowestFret:!0,splittedChord:!1,openString:!1},bar:{rootIsLowestNote:!0,rootOnLowestFret:!0,barredString:[3,6],noMuteAfterFirstNote:!0,splittedChord:!1,openString:!1}};try{if("string"==typeof a)a=j(a),l=a[0],h=a[1],q.push(l),m=o.indexOf(l);else throw n.invalidChordName;k=f(p,h),r=k.integer.split("-")}catch(a){return s.error=n.invalidChordName,s}for(var u,v=1;v<r.length;v++)u=parseInt(r[v])+parseInt(m),u>o.length-1&&(u-=o.length),q.push(o[u]);var w,x=[],y=0;for(y=0;y<this.tuning.length;y++){x[y]=[],x[y].push("x");for(var z=0;z<q.length;z++)w=o.indexOf(q[z])-o.indexOf(this.tuning[y]),0>w&&(w=o.length+w),x[y].push(w),w+12<this.fretNumber&&x[y].push(w+12)}var A=[];for(y=0;y<this.tuning.length;y++)for(var B=A.length,C=0;C<x[y].length;C++)if(A[C]){for(var D=0;D<B;D++)if(0==C)A[D].push(x[y][C]);else{var E=A[D].slice(0);E.pop(),E.push(x[y][C]),A.push(E)}}else A[C]=[x[y][C]];var F=[],G=function(a,b){for(var c in a){if(!b.hasOwnProperty(c))return!1;if("object"===_typeof(a[c])){var d=a[c][0],e=a[c][1];if(b[c]<d||b[c]>e)return!1}else if(b[c]!==a[c])return!1}return!0};try{for(var H=d;H<A.length;H++)if(b(A[H],q,this.tuning)&&g(A[H],"max")-g(A[H],"min")<this.maxSpan&&function(){var a={openString:!1,frettedNotes:0},b=A[H].join(""),c=/[0-9]+[x]+[0-9]+/gi,d=/[0-9]+[x]+/gi;a.splittedChord=!!c.test(b),a.noMuteAfterFirstNote=!d.test(b);for(var f,h=0;h<A[H].length;h++)if(f=A[H][h],!isNaN(f)){var i=f+o.indexOf(e.tuning[h]);0===f&&(a.openString=!0),m===i&&(0===a.frettedNotes&&(a.rootIsLowestNote=!0),a.rootBelow4thFret=!!(4>=f),a.rootOnLowestFret=!!(g(A[H],"min")>=f)),(0<f&&h<A[H].length-1&&f===A[H][h-1]||3<=g(A[H],f))&&(a.barredString=isNaN(a.barredString)?1:a.barredString+1),a.frettedNotes++}var j={tab:A[H],tag:[]};Object.getOwnPropertyNames(t).forEach(function(b){G(t[b],a)&&j.tag.indexOf(b)&&j.tag.push(b)}),F.push(j)}(),0<c&&c<A[H].length&&F.length===c){d=H+1;break}}catch(a){console.error(a)}return s.chordList=F,s.offset=d,s}},{key:"getChordLayout",value:function(a,b){var e,f,c=Math.abs,g=this.fretsToDisplay;try{e=d(b)?k(b):[0,0,0,0,0,0]}catch(a){return!1}for(var h=[],j=0;j<e.length;j++)!1===isNaN(e[j])&&h.push(e[j]);var o=c(l.apply(Math,h)),p=c(m.apply(Math,h)),q=1;o>=g&&(q=0<p?p:1),1===q&&5<o&&(q=o-g+2);try{if(0===g)g=o-q+2;else if(o-q+1>g-1)throw g=o-q+2,n.croppedChordLayout}catch(a){console.error(a)}f="<table class=\"chord\">";for(var r,s=0;s<g;s++){r=s+q-1,1===q&&0==s&&(f+="<thead>"),f+=r%2&&0<r?"<tr><th class=\"fret-number\">"+r+"</th>":"<tr><th></th>";for(var t,u=0;u<this.tuning.length;u++)t=parseInt(e[u]),f+=0==s?0===t?"<th><div class=\"dot open\"></div></th>":"<th></th>":t===q+s-1?"<td><div class=\"dot plain\">"+e[u]+"</div></td>":"<td></td>";f+=1===q&&0==s?"<tr></thead>":"</tr>"}return f+="<caption align=\"bottom\">"+a+"</caption>",f+="</table>",f}}]),a}();return a.Instrument=q,a.isValidTab=d,a.isValidTuning=c,a}({});